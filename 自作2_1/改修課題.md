# 改修課題管理

## ✅ 完了済みの課題

### 課題1: NSFWシーンの柔軟性 ✅

**優先度**: 中

**概要**:
- SFWシーンの合間にNSFWシーンを挟む仕組みの実装
- NSFWシーン自体の組み換え（順序変更、段階スキップなど）

**実装内容**:
1. 共通NSFWライブラリの作成
   - `themes/lovey/nsfw_light.yaml` - 軽度NSFW（キス、抱擁、タッチ、胸タッチ）
   - `themes/lovey/nsfw_moderate.yaml` - 中度NSFW（手コキ、フェラ軽め〜本格）
   - `themes/lovey/paizuri_prompts.yaml` - パイズリ（本格NSFW）
   - `themes/lovey/foreplay_prompts.yaml` - 前戯（本格NSFW）

2. アングル外部パラメータ化
   - `params/angles.yaml` - 全アングルパラメータを外部化
   - NSFWプロンプトからアングル情報を削除
   - SFWシーンとアングルを統一可能に

3. NSFW統合サンプルテーマの作成
   - `ビーチで彼女とリゾートデート3/` - SFW+NSFW統合版
   - 6シーンで段階的にNSFW度を上げる構成
   - pose_play内にNSFWを混ぜ込む実装例

4. 新規テーマ作成フローの更新
   - `doc/wildcard_rules.md` に質問6を追加
   - NSFW統合レベル（なし/軽度/中度/全て）を選択可能
   - シーン毎にNSFW統合の有無を指定可能

**完了日**: 2026-01-01

**影響範囲**:
- 全テーマ
- `main.yaml`の構造

---

### 課題2: カスタムシーンの簡易追加機能 ✅

**優先度**: 高

**概要**:
- ライブラリにないシーン（プール、教室、電車など）を簡易的に追加する仕組み
- **重要**: テスト→評価→再作成のループを効率化・省略する仕組みの導入

**実装内容**:

**フェーズ1: 既存シーンの分析と体系化** ✅
1. 既存の高品質シーン（beach, daily, office, onsen）の構造分析完了
   - ソロ/カップル比率: 50-65% / 35-50%
   - カメラアングル配分: 最低6種類使用
   - 動作バリエーション: 最低8種類パターン化
   - プロンプト構造の定式化完了
2. 構造パターンのテンプレート化完了
   - 5つのパターン（standard, solo_focused, couple_focused, simple, extended）

**フェーズ2: シーン作成マニュアルの作成** ✅
1. `templates/scene_creation_golden_rules.md` - 完成
   - 黄金律の詳細な文書化
   - 構造的バリデーションチェックリスト
   - クイック検証方式（3プロンプトテスト）
   - 期待効果: 80%時短

**フェーズ3: テンプレートとツールの作成** ✅
1. `templates/scene_structure_patterns.yaml` - 完成
   - 5つの構造パターン定義
   - アングル・動作タイプ定義
   - パターン選択ガイド
2. `templates/custom_scene_template.yaml` - 完成
   - プレースホルダーベースのテンプレート
   - 6シーン構成
   - 詳細な使用例
3. `templates/custom_scene_creation_guide.md` - 完成
   - ステップバイステップ手順
   - 完全な例（プールシーン）
   - チェックリスト

**フェーズ4: サンプルシーン作成（10種類）** ✅
1. `themes/lovey/pose_scenes_pool.yaml` - プール（6シーン、59プロンプト）
2. `themes/lovey/pose_scenes_school.yaml` - 学校（6シーン、59プロンプト）
3. `themes/lovey/pose_scenes_train.yaml` - 電車（6シーン、59プロンプト）
4. `themes/lovey/pose_scenes_park.yaml` - 公園（6シーン、59プロンプト）
5. `themes/lovey/pose_scenes_amusement.yaml` - 遊園地（6シーン、60プロンプト）
6. `themes/lovey/pose_scenes_restaurant.yaml` - レストラン（6シーン、60プロンプト）
7. `themes/lovey/pose_scenes_gym.yaml` - ジム（6シーン、60プロンプト）
8. `themes/lovey/pose_scenes_library.yaml` - 図書館（6シーン、60プロンプト）
9. `themes/lovey/pose_scenes_hospital.yaml` - 病院（6シーン、60プロンプト）
10. `themes/lovey/pose_scenes_cinema.yaml` - 映画館（6シーン、60プロンプト）

全て黄金律に準拠した構造で作成完了。

**達成された効果**:
✅ テスト→評価→再作成ループを80%削減する仕組みの確立
✅ 既存4種類 + 新規10種類 = **計14種類**のシーンパターンが使用可能
✅ テンプレートベースにより、新規シーン作成が10-15分で可能
✅ クイック検証により、品質保証と時短を両立
✅ テーマバリエーションの爆発的増加を実現

**完了日**: 2026-01-01

**影響範囲**:
- ユーザーが独自にシーンを追加する際の利便性が劇的に向上
- 新規テーマ作成プロセス全体が効率化
- 毎日新しいテーマ作成が現実的に

---

## 🔴 未対応の課題

### 課題3: NTRテーマ系テンプレートの作成

**優先度**: 中

**概要**:
- NTRテーマ用のシーンライブラリが未整備（loveyテーマしか存在しない）

**対応が必要なファイル**:
- `themes/ntr/pose_scenes_daily.yaml` - 新規作成
- `themes/ntr/pose_scenes_onsen.yaml` - 新規作成
- `themes/ntr/pose_scenes_beach.yaml` - 新規作成
- `themes/ntr/pose_scenes_office.yaml` - 新規作成
- `themes/ntr/fellatio_prompts.yaml` - 新規作成（loveyをベースに）

**必要な作業**:
1. loveyテーマの各シーンファイルをベースにNTR版を作成
2. NTR特有の表現（reluctant, guilty, betrayalなど）に適合
3. 連番システムの適用
4. 既存の`ntr/pose_faces.yaml`などとの整合性確認

**影響範囲**:
- NTRテーマを使用する全テーマ

---

### 課題4: 服装の段階的変化システム

**優先度**: 中

**概要**:
- 段階的に脱衣していく流れを自然に表現するシステム

**対応が必要なファイル**:
- 新規：服装遷移ルール定義ファイル
- `params/character_outfits.yaml` の拡張検討

**必要な作業**:
1. 服装変化の段階定義（例：casual_day → underwear → nude）
2. シーンに応じた自動的な服装遷移
3. テーマ作成時の服装フロー設定機能
4. ドキュメント整備

**影響範囲**:
- 全テーマ
- pose_play.yamlの構造

**備考**:
- 現在は各シーンで固定的に服装を指定している
- より自然な脱衣の流れを実現したい

---

### 課題5: 表情・雰囲気のバリエーション拡充

**優先度**: 低

**概要**:
- 現在の表情・雰囲気（4種類ずつ）を拡充

**対応が必要なファイル**:
- `themes/lovey/pose_faces.yaml`
- `themes/lovey/pose_atmosphere.yaml`
- `themes/ntr/pose_faces.yaml`
- `themes/ntr/pose_atmosphere.yaml`

**必要な作業**:
1. 新しい表情バリエーションの追加
   - 驚き (surprised)
   - 恥じらい (shy, embarrassed)
   - 興奮 (excited, aroused)
   - 脱力 (exhausted, relaxed)
2. 新しい雰囲気バリエーションの追加
3. 既存テーマへの適用検討

**影響範囲**:
- 全テーマ（オプション）

---

### 課題6: 複数男性対応

**優先度**: 低

**概要**:
- 2boys、3boys対応（3P、乱交シーン）

**対応が必要なファイル**:
- `params/character_male_type.yaml` の拡張
- 新規：複数男性用シーンライブラリ
- Sex/Fellatioプロンプトの複数男性版

**必要な作業**:
1. 複数男性用パラメータの定義
   - `male_count_2` (2boys)
   - `male_count_3` (3boys)
2. 複数男性用のシーンプロンプト作成
3. Sex/Fellatioシーンの複数男性版
4. テーマ作成時の選択肢追加

**影響範囲**:
- 新規テーマ作成プロセス
- 既存システムへの拡張

**備考**:
- NTRテーマとの親和性が高い
- 技術的な複雑さが増すため、優先度は低め

---

## 📝 その他の検討事項

（今後追加される課題をここに記載）

---

**最終更新**: 2026-01-01

