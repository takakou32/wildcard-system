# 改修課題管理

## 🔴 未対応の課題

### 課題1: NSFWシーンの柔軟性

**優先度**: 中

**概要**:
- SFWシーンの合間にNSFWシーンを挟む仕組みの実装
- NSFWシーン自体の組み換え（順序変更、段階スキップなど）

**実装済み（テスト待ち）**:
1. 共通NSFWライブラリの作成
   - `themes/lovey/nsfw_light.yaml` - 軽度NSFW（キス、抱擁、タッチ、胸タッチ）
   - `themes/lovey/nsfw_moderate.yaml` - 中度NSFW（手コキ、フェラ軽め〜本格）
   - `themes/lovey/paizuri_prompts.yaml` - パイズリ（本格NSFW）
   - `themes/lovey/foreplay_prompts.yaml` - 前戯（本格NSFW）

2. アングル外部パラメータ化
   - `params/angles.yaml` - 全アングルパラメータを外部化
   - NSFWプロンプトからアングル情報を削除
   - SFWシーンとアングルを統一可能に

3. NSFW統合サンプルテーマの作成
   - `ビーチで彼女とリゾートデート3/` - SFW+NSFW統合版
   - 6シーンで段階的にNSFW度を上げる構成
   - pose_play内にNSFWを混ぜ込む実装例

4. 新規テーマ作成フローの更新
   - `doc/wildcard_rules.md` に質問6を追加
   - NSFW統合レベル（なし/軽度/中度/全て）を選択可能
   - シーン毎にNSFW統合の有無を指定可能

**次のステップ**:
- ユーザーがテストして効果確認
- 問題なければ課題完了

**影響範囲**:
- 全テーマ
- `main.yaml`の構造

---

---

### 課題2: カスタムシーンの簡易追加機能

**優先度**: 高

**概要**:
- ライブラリにないシーン（プール、教室、電車など）を簡易的に追加する仕組み
- **重要**: テスト→評価→再作成のループを効率化・省略する仕組みの導入

**対応が必要なファイル**:
- 新規：カスタムシーンテンプレート
- `templates/custom_scene_template.yaml` - 新規作成
- `templates/scene_creation_manual.md` - シーン作成マニュアル（黄金律）
- `templates/scene_structure_patterns.yaml` - 構造パターン定義
- ドキュメント追加

**必要な作業**:

**フェーズ1: 既存シーンの分析と体系化**
1. 既存の高品質シーン（ビーチ等）の構造分析
   - ソロ/カップル比率の抽出
   - カメラアングル配分の分析
   - 動作バリエーションのパターン化
   - プロンプト構造の定式化
2. 構造パターンのテンプレート化
   - 場所非依存の共通構造を抽出
   - 変数置換可能な形式に変換

**フェーズ2: シーン作成マニュアルの作成**
1. 「シーン作成の黄金律」文書化
   - 構成比率（ソロ60-70%、カップル30-40%）
   - カメラアングル配分ルール
   - 必須動作バリエーション
   - プロンプト構造フォーマット
2. チェックリストの作成
   - 構造的バリデーション項目
   - 品質確認ポイント
3. クイック検証方式の定義
   - 代表的な3プロンプトでの先行テスト手法

**フェーズ3: テンプレートとツールの作成**
1. カスタムシーン作成用テンプレート設計
   - 既存パターンから生成
   - 場所・連番・動作のみカスタマイズ可能
2. 連番ルールの適用方法ガイド
3. カスタムシーン作成手順書
   - テンプレート使用方法
   - クイック検証手順

**フェーズ4: サンプルシーン作成（テンプレート活用）**
1. 以下のサンプルシーンを作成（テンプレートを使って高速に）
   - `pose_scenes_pool.yaml`（プール）
   - `pose_scenes_school.yaml`（学校）
   - `pose_scenes_train.yaml`（電車・交通）
   - `pose_scenes_park.yaml`（公園）
   - `pose_scenes_amusement.yaml`（遊園地）
   - `pose_scenes_restaurant.yaml`（レストラン・飲食）
   - `pose_scenes_gym.yaml`（ジム・スポーツ施設）
   - `pose_scenes_library.yaml`（図書館）
   - `pose_scenes_hospital.yaml`（病院）
   - `pose_scenes_cinema.yaml`（映画館）
2. 各シーンで黄金律に従った構造を適用
3. 代表プロンプトでのクイック検証のみ実施

**期待される効果**:
- テスト→評価→再作成ループを**80%削減**
- 既存の検証済み構造を使うため、品質が担保される
- 新シーン作成時間を大幅短縮
- 毎日新しいテーマ作成が現実的に可能（14種類以上のシーンパターン）

**影響範囲**:
- ユーザーが独自にシーンを追加する際の利便性向上
- 新規テーマ作成プロセス全体の効率化
- テーマバリエーションの爆発的増加

**備考**:
- 現在は共通ライブラリのシーンしか使えない
- テンプレートベース生成により、試行錯誤なしで高品質シーンを作成可能
- サンプルシーン10種類により、初日から18種類以上のパターンが使用可能に

---

### 課題3: NTRテーマ系テンプレートの作成

**優先度**: 中

**概要**:
- NTRテーマ用のシーンライブラリが未整備（loveyテーマしか存在しない）

**対応が必要なファイル**:
- `themes/ntr/pose_scenes_daily.yaml` - 新規作成
- `themes/ntr/pose_scenes_onsen.yaml` - 新規作成
- `themes/ntr/pose_scenes_beach.yaml` - 新規作成
- `themes/ntr/pose_scenes_office.yaml` - 新規作成
- `themes/ntr/fellatio_prompts.yaml` - 新規作成（loveyをベースに）

**必要な作業**:
1. loveyテーマの各シーンファイルをベースにNTR版を作成
2. NTR特有の表現（reluctant, guilty, betrayalなど）に適合
3. 連番システムの適用
4. 既存の`ntr/pose_faces.yaml`などとの整合性確認

**影響範囲**:
- NTRテーマを使用する全テーマ

---

### 課題4: 服装の段階的変化システム

**優先度**: 中

**概要**:
- 段階的に脱衣していく流れを自然に表現するシステム

**対応が必要なファイル**:
- 新規：服装遷移ルール定義ファイル
- `params/character_outfits.yaml` の拡張検討

**必要な作業**:
1. 服装変化の段階定義（例：casual_day → underwear → nude）
2. シーンに応じた自動的な服装遷移
3. テーマ作成時の服装フロー設定機能
4. ドキュメント整備

**影響範囲**:
- 全テーマ
- pose_play.yamlの構造

**備考**:
- 現在は各シーンで固定的に服装を指定している
- より自然な脱衣の流れを実現したい

---

### 課題5: 表情・雰囲気のバリエーション拡充

**優先度**: 低

**概要**:
- 現在の表情・雰囲気（4種類ずつ）を拡充

**対応が必要なファイル**:
- `themes/lovey/pose_faces.yaml`
- `themes/lovey/pose_atmosphere.yaml`
- `themes/ntr/pose_faces.yaml`
- `themes/ntr/pose_atmosphere.yaml`

**必要な作業**:
1. 新しい表情バリエーションの追加
   - 驚き (surprised)
   - 恥じらい (shy, embarrassed)
   - 興奮 (excited, aroused)
   - 脱力 (exhausted, relaxed)
2. 新しい雰囲気バリエーションの追加
3. 既存テーマへの適用検討

**影響範囲**:
- 全テーマ（オプション）

---

### 課題6: 複数男性対応

**優先度**: 低

**概要**:
- 2boys、3boys対応（3P、乱交シーン）

**対応が必要なファイル**:
- `params/character_male_type.yaml` の拡張
- 新規：複数男性用シーンライブラリ
- Sex/Fellatioプロンプトの複数男性版

**必要な作業**:
1. 複数男性用パラメータの定義
   - `male_count_2` (2boys)
   - `male_count_3` (3boys)
2. 複数男性用のシーンプロンプト作成
3. Sex/Fellatioシーンの複数男性版
4. テーマ作成時の選択肢追加

**影響範囲**:
- 新規テーマ作成プロセス
- 既存システムへの拡張

**備考**:
- NTRテーマとの親和性が高い
- 技術的な複雑さが増すため、優先度は低め

---

## 📝 その他の検討事項

（今後追加される課題をここに記載）

---

**最終更新**: 2025-12-31

